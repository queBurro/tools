http://www.youtube.com/watch?v=-Ya1dQ1Igkc

??$ p s v e r s i o n t a b l e 
  v e r s i o n 3   l i k e s   . n e t 4 
  p s   b u i l t   o n   f r a m e w o r k ,   s o   l a t e r   t h e   f w   t h e   b e t t e r   t h e   p s 
 $ h o s t . P r i v a t e D a t a . E r r o r F o r e g r o u n d C o l o r   =   ' g r e e n ' 
  d i r   - r e c u r s e   
  h e l p   * s e r v i c e * 
 @ 1 8   " d i s c o v e r a b i l i t y   f e a t u r e s " 
 U p d a t e - H e l p 
 v e r b - s i n g u l a r N o u n 
 h e l p   G e t - S e r v i c e   - f u l l 
 e x a m p l e s   a t   t h e   b o t t o m 
 h e l p   G e t - S e r v i c e   - o n l i n e 
 [ ] i n   h e l p   m e a n s   o p t i o n a l   ( i n   s h e l l   s o m e t h i n g   d i f f e r e n t ) 
 c l s 
 @ 3 0   p s 3   t r i c k   s h o w - 
 @ 3 1 : 3 0   s h o w - c o m m a n d   g e t - p r o c e s s   
 G e t - E v e n t L o g   - l i s t 
 g e t - c o m m a n d   * s e r v i c e *   @ 4 0 
 " a c c e s s   c o n t r o l   l i s t "   a c l 
 d i r   |   m o r e         < -   p i p e s   l o o k   t h e y   p i p e   t e x t   b u t   t h e y   d o n ' t ! 
 g e t - s e r v i c e       < -   a u t o ,   m a n u a l   e t c .   n o t   s h o w e d 
 h e l p   = =   " g e t - h e l p   z z z   |   m o r e "     < - a l i a s ' d 
 h e l p   g e t - c o m m a n d   g e t - m e m b e r   <   3   m o s t   i m p o r t a n t   c o m m a n d s 
 @ 4 8 : 2 3     r o w = = o b j e c t   c o l u m n s = = p r o p e r t y 
 T y p e N a m e :   i t s   n a m e s p a c e ! !   n o   i t ' s   n o t ,   i t   t e l l s   y o u   t h e   t p y e   o f   o b j e c t   p r o d u c e d   ( t h e   o b j e c t   i n   t h e   p i p e l i n e ) 
 @ 4 9 : 5 3   g e t - p r o c e s s   |   s t o p - p r o c e s s   - w h a t i f           - c o n f i r m 
 < -   t h i s   i s   N O T   t e x t   o u t p u t !   i t ' s   o b j e c t s   ( d a t a   s t r u c t u r e s ) 
 @ 5 1 : 2 9   p s   i s   p a t e n t e d   
 @ 1 : 0 4   i m p o r t - c s v   c o m m a n d 
 i m p o r t - c s v   n o t e s . c s v   |   n e w - a d u s e r   <   
 @ 1 : 0 9   s t o p - c o m p u t e r 
 @ 1 : 1 2   c o m e s   b a c k   f r o m   b r e a k 

 g e t - p r o c e s s   |   S o r t - O b j e c t   - P r o p e r t y   p m   - D e s c e n d i n g   |   S e l e c t - O b j e c t   - F i r s t   1 0   n a m e , i d , p m , v m 
 G e t - P r o c e s s   |   E x p o r t - C l i x m l   b a s e l i n e . x m l 
 c o m p a r e - o b j e c t   <   d i f f i n g 
 c o n v e r t T o - h t m l   - f r a g m e n t   <   c h e c k   t h i s   o u t 
 - e q       = =   
   ' h e l l o '   - c e q   ' H E L L O '       f a l s e         > C < a s e s e n s i t i v e 
 @ 1 : 2 7   ' h e l l o '   - l i k e   ' * l l * '       t r u e           >   l i k e   f r o m   S Q L 
 t e c h n e t . c o m   p o w e r s h e l l   c o l u m n   d o n 
 G e t - S e r v i c e   |   W h e r e - O b j e c t   - F i l t e r S c r i p t   {   $ _ . S t a t u s   - e q   ' R u n n i n g '   } 
 g s v   |   W h e r e   {   $ _ . S t a t u s   - e q   ' R u n n i n g '   } 
 g s v   |   ?   {   $ _ . S t a t u s   - e q   ' R u n n i n g '   } 
 h e l p   g s v 
 g a l   g a l 
 @ 1 : 3 3   r e g i s t r y 
 
 c d   h k l m : 
 c d   c : 
  G e t - P S D r i v e     p o w e r s h e l l   d r i v e s 
 g a l   c a t         
 g a l   t y p e 
 G e t - C o n t e n t   E n v : \ C O M P U T E R N A M E 
 E n v   i s   * j u s t *   a   ( p o w e r s h e l l )   d r i v e ,   t h e   s a m e   a s   C :   e t c . 
 @ 1 : 3 7 : 4 0   b l a n k   t o o l   ,   s n a p   i n s 
 G e t - P S S n a p i n       - h w t a   s n a p i n s   d o   I   h a v e ? 
 a d d - p s s n a p i n         " m o d u l e s "   a r e   p s 2   s n a p i n s 
 
 @ 1 : 4 0 
 g e t - m o d u l e   - L i s t A v a i l a b l e 
 i m p o r t - m o d u l e   z z z z                     l o a d s   i n t o   m e m o r y 
 g e t - c o m m a n d   - m o d u l e   z z z z         l i s t s   c o m m a n d s 
 
 i n   p s 3 ,   t h e r e ' s   m o d u l e   a u t o   d i s c o v e r y 
 
 @ 1 : 4 3   " r e m o t i n g "   f r o m   W i n 8 ,   e v e r y t h i n g   u s e s   t h i s   o n e   p r o t o c o l ! !   " W S M a n "   w e b   s e r v i c e s   f o r   m a n a g e m e n t   ( R F C ' s   n o t   a   w i n d o w s   p r o t o c o l   i n c   u n i x )   o n e   p o r t !   5 9 8 5   5 9 8 6   i s   s l l   v e r s i o n   ( h t t p s ) 
 
 n o   m o r e   p s e x e c !     p o w e r s h e l l ' s   v e r s i o n   o f   s s h 
 @ 1 : 4 9 
 e n t e r - p s s e s s i o n   - c o m p u t e r n a m e   X X X X           c r e d e n t i a l s   c a n ' t   h o p   t w i c e
   g e t - m o d u l e   - L i s t A v a i l a b l e       < -   r e a d   t h i s 
 @ 1 : 5 2   c a n   r e m o t e   i n t o   2 0   s e r v e r s   a t   s a m e   t i m e   a n d   d o   t h i s 
 - T h r o t t l e L i m i t   ( e a c h   r e m o t e   c o n n e c t i o n   h a s   o n e   p o w e r s h e l l ) 
 @ 2 : 0 0   g i v i n g   H R   l i m i t e d   c o m m a n d s   o n   a n   e n d p o i n t 

endpoint - different configuarionName of powershell of endpoint of powershell

@205 get-module | remove-module     unloads everything     no AD modules
get-PsSNapin | remove-PSSNapin     remove all snapins that it’ll let you  “naked powershell”
206 created persistant connection to other coomputer

get-aduser
looks like it ran locally (implicit remoting) so let them live on server, doesn’t have to be installed on clients
@210 profiles
help about_profiles

@2:13 no more GUIs on windows server

@2:17 trouble shooting
Enter-PSSession -ComputerName sss  etc. then run same wizard from the command line
can only remote in via AD’s hostname, if you want to use dns/IP have to add to trusted hosts

@2:25 enable tracing - diagnostics    SHOW DEBUG LOGS
disable tracing

@2:26 - save a trace from good computer, then diff that against the bad one
@2:27 lunch break

@233 Root\Common Information

@237 Get-WmiObject -class win32_bios | get-member
Get-WmiObject -class win32_operatingsystem | select -Property *

SELECT - picks columns
WHERE - filters  ...like SQL

@246 formatting shell output
@250 custom columns   FormatString=’F2’  float point , 2dp
Out-File zzz.txt -append     same as >>
@2:53     out-gridview!!
@2:55 don’t use format, use select-object,

filter left,    format right 

@259 credential object (password)

-asjob runs job in background (like shell&) - obviously only shows in that shell

@305 get-job gets you the list of jobs back

receive-job -id 3 -keep         gets you the results, only    keep doesn’t throw away results
remove-job -id 2              gets rid of the kept jobs
stop-job -id 8
in v3 you can schedule jobs with this (results is then cached to disc)

@312 i/o     read-host “add something”
write-host <- don’t use this, can’t convert it to html, or csv, just drawings on screen
write-output … can redirect, export etc.

get-command -verb write

@320 - execution policy   
get-executionPolicy
.ps1 opens up with notepad  - by design

@323 “principle of least privilege” 
powershell needs a path, e.g.    ./test   current directory works 
scripts have paths
commands don’t 

@328 another break!

$x = 5               variables,   “x” is the variable name
${this is also, a variable}    curly brackets let you name whatever you want <- don’t do this

$s = get-service
$s[3] = one of the services

@332 PS C:\Users\tb> $a = "World"
PS C:\Users\tb> $b = "hello $a"
PS C:\Users\tb> $b
hello World



PS C:\Users\tb> $x = 5
PS C:\Users\tb> $y = '5'
PS C:\Users\tb> $x + $y     casting occurs
10
PS C:\Users\tb> $y + $x
55                              
thus:
[int]$age = read-host “enter your age”

@336 writing your own cmdlet

@346 mandatory parmeters      
write-verbose    messages show up when run with -verbose

@350 -debug 

common-parameters 
-debug verbose full detailed?
@353 one shell

@358 powershell tool making

help about*
help about_scripts

http://bit.ly/AskDon
powershell.com
connect.microsoft.com
@4:05:16 
make it part of your job
get automating in to my job dscription
automating - “part of my job this year will be to automate a task a that takes us 5 hours to do...” a metric on me, this will save us 5 hours in the course of a year
if I’ve not done it... “you didn’t give me the time I needed”

---

powershell notes..

Enter-PSSession -computerName tfsbuildwsper

---
from google drive...
  PS C:\_ws\tfs\collnView\fb\fb01> ls -r *.sln -File -Filter "*.sln" | Select-Object Name | Sort-Object Name
  get-adgroupmember tfs_testers | select name   <- ran this on tfsbuildwsper1, as it's an installed feature
  get-adgroupmember tfs_member | select name

  ^ run command on different box...
  enter-pssession tfsbuildwsper1
  invoke-command -computername tfsbuildwsper1 {get-adgroupmember tfs_member | select name}
http://stackoverflow.com/questions/25856517/get-list-of-checked-out-files-in-tfs-error 
